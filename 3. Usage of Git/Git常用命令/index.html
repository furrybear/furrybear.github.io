<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="Furrybear">
    <link rel="canonical" href="https://furrybear.readthedocs.com/3. Usage of Git/Git常用命令/">
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Git常用命令 - Furrybear's Blog</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Git\u5e38\u7528\u547d\u4ee4", url: "#_top", children: [
              {title: "\u5e38\u89c1\u547d\u4ee4", url: "#_1" },
              {title: "\u5e38\u89c1\u7528\u6cd5", url: "#_2" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Git常见问题/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Git常见问题/" class="btn btn-xs btn-link">
        Git常见问题
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Git基础知识/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Git基础知识/" class="btn btn-xs btn-link">
        Git基础知识
      </a>
    </div>
    
  </div>

    

    <h1 id="git">Git常用命令</h1>
<h2 id="_1">常见命令</h2>
<h3 id="git-clone">git clone</h3>
<p>主要用于克隆仓库。</p>
<pre><code class="sh"># 只克隆这个仓库
git clone &lt;远程仓库的URL&gt;
# 克隆这个仓库和它的所有子模块
git clone --recursive &lt;远程仓库的URL&gt;
</code></pre>

<p>值得注意的是，<code>git clone &lt;URL&gt;</code>默认是克隆远程仓库里HEAD指向的分支，默认是master分支。如果是多分支，我们可以克隆远程仓库的某个分支：</p>
<pre><code class="sh">git clone -b &lt;分支名&gt; &lt;URL&gt;
</code></pre>

<p>如果克隆的是一个空仓库，会报“warning: remote HEAD refers to nonexistent ref, unable to checkout.”警告，因为远程仓库没有任何commit，所以HEAD不指向任何commit。</p>
<h3 id="git-checkoutgit-branch">git checkout和git branch</h3>
<p>检出分支和查看分支情况</p>
<pre><code class="sh"># 创建新分支，新分支会有和之前分支相同的提交历史（commit history）
git checkout -b &lt;分支名&gt;
# 创建新分支，新分支没有提交历史
git checkout --orphan &lt;分支名&gt;
# 检出已经存在的分支
git checkout &lt;分支名&gt;
# 查看本地仓库有哪些分支
git branch
# 删除本地分支
git branch -d &lt;分支名&gt;
# 查看本地分支与远程分支的追踪情况
git branch -vv
# 分支改名
git branch -m &lt;旧分支名&gt; &lt;新分支名&gt;
# 查看所有分支（包括远程分支）
git branch -a
# 查看所有远程分支
git branch -r
# 创建本地分支dev，该分支与远程dev分支相同
git checkout -b dev origin/dev
</code></pre>

<h3 id="git-log">git log</h3>
<pre><code class="sh"># 查看提交(commit)历史
git log
# 以图的形式查看提交之间的关系
git log --graph
# 每个提交只显示提交ID
git log --graph --oneline
</code></pre>

<h3 id="git-commit">git commit</h3>
<p>将暂存区记录的改动添加到本地仓库创建一个新的commit。</p>
<pre><code class="sh"># 创建一个新的commit，HEAD指针指向这个commit
git commit -m &quot;&lt;commit message&gt;&quot;
# 删掉HEAD指针指向的commit，创建一个新的commit，HEAD指针指向这个commit
git commit --amend -m &quot;&lt;commit message&gt;&quot;
# 更新最近一次的提交，不改变提交信息，但是修改提交时间为现在
git commit --amend --date=now --no-edit
</code></pre>

<h3 id="git-statusgit-diff">git status和git diff</h3>
<pre><code class="sh"># 查看工作区和暂存区文件改动涉及的文件（和HEAD比较）
git status
# 查看工作区的文件改动（和HEAD比较）
git diff
# 查看暂存区的文件改动（和HEAD比较）
git diff --cached
</code></pre>

<h3 id="git-remote">git remote</h3>
<p>管理远程主机。
　　</p>
<pre><code class="sh"># 为远程主机设置多个URL
git remote set-url --add &lt;主机名&gt; &lt;URL&gt;
</code></pre>

<h3 id="git-push">git push</h3>
<p>将本地分支推送到远程分支。注意，如果本地分支和远程分支的提交历史中如果有不同commit（一般发生在分支上用<code>git reset</code>回退版本再commit后），将无法推送，除非加<code>-f</code>参数强行覆盖远程分支。</p>
<pre><code class="sh"># 将本地分支推送到它追踪的远程分支
git push
# 将本地分支推送到某个远程分支
git push &lt;远程主机名&gt; &lt;本地分支名&gt;:&lt;远程分支名&gt;
# 将本地分支推送到某个远程分支并建立追踪关系
git push --set-upstream &lt;远程主机名&gt; &lt;本地分支名&gt;:&lt;远程分支名&gt;
git push -u &lt;远程主机名&gt; &lt;本地分支名&gt;:&lt;远程分支名&gt;
# 删除远程主机上的分支
git push &lt;远程主机名&gt; --delete &lt;远程分支名&gt;
# 删除远程主机上的标签
git push &lt;远程主机名&gt; :ref/tags/&lt;标签名&gt;
</code></pre>

<h3 id="git-reset">git reset</h3>
<p>主要用于在分支上回退版本。
　　</p>
<pre><code class="sh"># 将暂存区所有文件改动清除
git reset
</code></pre>

<p>对于git reset三个参数“--soft”、“--mixed”（默认）和“--hard”，区别如下：</p>
<pre><code class="sh"># 本地版本库的头指针重置到指定版本，并将这次提交之后的所有变更都移动到暂存区,工作区代码不变
git reset --soft &lt;版本号&gt; [&lt;文件名1&gt;,&lt;文件名2&gt;,…]
# 本地版本库的头指针重置到指定版本，并清空暂存区,工作区代码不变
git reset &lt;版本号&gt; [&lt;文件名1&gt;,&lt;文件名2&gt;,…]
# 本地版本库的头指针重置到指定版本，并清空暂存区，工作区代码也回退到这个版本
git reset --hard &lt;版本号&gt; [&lt;文件名1&gt;,&lt;文件名2&gt;,…]
</code></pre>

<h3 id="git-rm">git rm</h3>
<pre><code class="sh"># 当需要删除暂存区或分支上的文件, 同时工作区也不需要这个文件了
git rm &lt;文件名&gt;
# 当需要删除暂存区或分支上的文件, 但本地又需要使用, 只是不希望这个文件被版本控制
git rm --cached &lt;文件名&gt;
</code></pre>

<h3 id="git-merge">git merge</h3>
<pre><code class="sh"># 将s分支合并到当前分支，s分支不会消失；如果当前分支的提交历史是s分支的子集，那么合并后当前分支就有和s分支一样的提交历史了
git merge s
</code></pre>

<h3 id="git-cherry-pick">git cherry-pick</h3>
<p>将两个提交合并，与merge不同，可以挑选哪些改动进行合并。</p>
<h3 id="git-rebase">git rebase</h3>
<p>可以对某一段线性提交历史进行编辑、删除、复制、粘贴；因此，合理使用rebase命令可以使我们的提交历史干净、简洁！</p>
<pre><code class="sh"># 交互式地重整该提交之后的提交（不包括该提交）
git rebase -i &lt;提交ID&gt;
# 交互式地重整所有提交
git rebase -i --root
</code></pre>

<h3 id="git-fetch">git fetch</h3>
<p>从远程仓库获取分支，更新本地的远程追踪分支，例如origin/master。</p>
<p><code>git pull</code>就是<code>git fetch</code>+<code>git merge</code>。假设远程仓库里有master分支，<code>git fetch origin master</code>先将远程的master分支放到本地的origin/master，然后再切到本地master，和origin/master进行merge。</p>
<pre><code class="sh"># 从远程仓库获取所有分支
git fetch --all
# 将工作区重整为origin/dev
git reset --hard origin/dev 
</code></pre>

<h3 id="git-config">git config</h3>
<p>config 配置有system级别、global（用户级别）和local（当前仓库，存储在.git/config），下层配置会覆盖上层配置。</p>
<pre><code class="sh"># 查看配置
git config --system --list
git config --global --list
git config --local  --list
# 设置用户名
git config user.name &quot;Furrybear&quot;
# 不忽略文件名大小写的修改
git config core.ignorecase false
# 允许推送分支到本仓库（非裸仓库）
git config --local receive.denyCurrentBranch ignore
</code></pre>

<h3 id="git-tag">git tag</h3>
<p>参考：
- <a href="http://www.ruanyifeng.com/blog/2012/07/git.html">http://www.ruanyifeng.com/blog/2012/07/git.html</a>
- <a href="https://www.zhihu.com/question/28784805">https://www.zhihu.com/question/28784805</a></p>
<p>标签就是给一个版本再取个别名，一般标记一个里程碑版本的。可以给任何版本打标签，一般给master分支的节点打标签。</p>
<p><img alt="" src="https://raw.githubusercontent.com/furrybear/res/master/img/20190302101927.png" /></p>
<pre><code class="sh"># 轻量级标签
git tag &lt;标签名&gt;  &lt;commitID&gt;
# 含附注标签
git tag -a &lt;标签名&gt; &lt;commitID&gt;
</code></pre>

<h3 id="git-symbolic-ref">git symbolic-ref</h3>
<pre><code class="sh">#设置裸仓库默认分支/设置HEAD指针指向
git symbolic-ref HEAD refs/heads/devel
</code></pre>

<h3 id="git-submodule">git submodule</h3>
<pre><code class="sh"># 添加子模块
git submodule add &lt;仓库名&gt; [&lt;目录名&gt;]
</code></pre>

<p>克隆新项目后如何克隆子模块：</p>
<pre><code class="sh"># 查看子模块情况
git submodule
# 初始化子模块
git submodule init
# 更新子模块到最新版本
git submodule update
</code></pre>

<h2 id="_2">常见用法</h2>
<h3 id="_3">工作流</h3>
<p>工作流是多人使用git进行协作的时候管理代码的一种约定规范。</p>
<h4 id="gitflow">简化的gitflow工作流</h4>
<p>这种工作流里有俩分支：master和dev，分别是生产环境中使用的代码和开发测试环境使用的代码。</p>
<p>在dev分支工作完后：</p>
<pre><code class="sh"># 如果功能开发完成了，可以合并主分支
git add .
git commit -m &quot;提交理由&quot;
# 切换到主分支
git checkout master
# 使用merge方法把dev分支的更改和master合并
git merge dev
# 提交主分支代码远程
git push
# 切换到dev远程分支
git checkout dev
# 提交dev分支到远程
git push
</code></pre>

<pre><code class="sh"># 如果功能没有完成，可以直接推送
git add .
git commit -m &quot;提交理由&quot;
git push  # 提交到dev远程分支
</code></pre>

  <br>
    

    
    
      
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Git常见问题/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Git常见问题/" class="btn btn-xs btn-link">
        Git常见问题
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Git基础知识/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Git基础知识/" class="btn btn-xs btn-link">
        Git基础知识
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/furrybear/blog/edit/master/docs/3. Usage of Git/Git常用命令.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>