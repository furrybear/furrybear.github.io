<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="Furrybear">
    <link rel="canonical" href="https://furrybear.readthedocs.com/2. Programming in Shell/Shell常用代码片段/">
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Shell常用代码片段 - Furrybear's Blog</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Shell\u5e38\u7528\u4ee3\u7801\u7247\u6bb5", url: "#_top", children: [
              {title: "\u8bbe\u7f6e\u4ee3\u7406", url: "#_1" },
              {title: "\u9047\u5230\u9000\u51fa\u503c\u4e3a\u975e0\u8bed\u53e5\u811a\u672c\u81ea\u52a8\u7ed3\u675f", url: "#0" },
              {title: "\u6253\u5370\u5de5\u4f5c\u76ee\u5f55", url: "#_2" },
              {title: "\u5faa\u73af", url: "#_3" },
              {title: "\u904d\u5386\u6570\u7ec4", url: "#_4" },
              {title: "\u904d\u5386Map", url: "#map" },
              {title: "\u9012\u5f52\u904d\u5386\u76ee\u5f55", url: "#_5" },
              {title: "\u5982\u679c\u6587\u4ef6\u91cc\u4e0d\u5b58\u5728\u67d0\u884c\uff0c\u5219\u5411\u6587\u4ef6\u91cc\u6dfb\u52a0\u8be5\u884c", url: "#_6" },
              {title: "\u811a\u672c\u6240\u5728\u76ee\u5f55", url: "#_7" },
              {title: "\u5224\u65ad\u5f53\u524d\u6587\u4ef6\u662f\u5426\u88ab\u76f4\u63a5\u8c03\u7528\u6267\u884c\uff08\u800c\u4e0d\u662fsource\u65b9\u5f0f\u6267\u884c\uff09", url: "#source" },
              {title: "Linux\u4e0b\u7ec8\u7aef\u8f93\u51fa\u6709\u989c\u8272\u7684\u5b57", url: "#linux" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Shell语法学习/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Shell语法学习/" class="btn btn-xs btn-link">
        Shell语法学习笔记
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Bash使用学习笔记/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Bash使用学习笔记/" class="btn btn-xs btn-link">
        Bash使用学习笔记
      </a>
    </div>
    
  </div>

    

    <h1 id="shell">Shell常用代码片段</h1>
<h2 id="_1">设置代理</h2>
<pre><code class="sh">export http_proxy=http://localhost:1080
export https_proxy=http://localhost:1080
</code></pre>

<h2 id="0">遇到退出值为非0语句脚本自动结束</h2>
<pre><code class="sh">set -e
</code></pre>

<h2 id="_2">打印工作目录</h2>
<pre><code class="sh">pwd
# 或者
echo $PWD
</code></pre>

<h2 id="_3">循环</h2>
<pre><code class="sh">for i in $(seq 0 4);do echo $i;done
for ((i=0;i&lt;5;i++));do echo $i;done  
for i in {0..4};do echo $i;done
</code></pre>

<h2 id="_4">遍历数组</h2>
<pre><code class="sh">arr=(&quot;value1&quot; 2)
# 遍历值
for value in ${arr[@]};do
    echo $value
done
# 遍历下标值
for idx in ${!arr[@]};do
    echo ${arr[$idx]}
done
</code></pre>

<h2 id="map">遍历Map</h2>
<pre><code class="sh">declare -A map=([&quot;key1&quot;]=&quot;value1&quot; [2]=&quot;value2&quot;)
# 遍历值
for value in ${map[@]};do
    echo $value
done
# 遍历键值
for key in ${!map[@]};do
    echo ${map[$key]}
done
</code></pre>

<h2 id="_5">递归遍历目录</h2>
<pre><code class="sh">traversal(){
    # 修改内部域分隔符（Internal Field Seprator）为\n，避免带空格的文件名被误认为两个文件
    local old_IFS=$IFS
    IFS=$'\n'
    traversal_rec .
    IFS=$old_IFS
}

traversal_rec() {
    for file in `ls $1`
    do
        # 判断是否是目录，是目录则递归
        if [ -d &quot;$1/$file&quot; ];
        then
            traversal_rec &quot;$1/$file&quot;
        else
            if [ ${file##*.} == 'md' ];then
                process_markdown &quot;$1/$file&quot;
            fi
        fi
    done
}
</code></pre>

<h2 id="_6">如果文件里不存在某行，则向文件里添加该行</h2>
<pre><code class="sh">grep 'alias sudo=&quot;sudo &quot;' /etc/bash.bashrc || echo 'alias sudo=&quot;sudo &quot;' | sudo tee -a /etc/bash.bashrc
</code></pre>

<h2 id="_7">脚本所在目录</h2>
<pre><code class="sh"># 相对路径或者绝对路径
SCRIPT_DIR=$(dirname &quot;$0&quot;)
# 绝对路径
SCRIPT_DIR=$(cd &quot;$(dirname \&quot;$0\&quot;)&quot;;pwd)
</code></pre>

<h2 id="source">判断当前文件是否被直接调用执行（而不是source方式执行）</h2>
<pre><code class="sh">if [[ &quot;${BASH_SOURCE[0]}&quot; == &quot;${0}&quot; ]]; then
    main &quot;$@&quot;
fi
</code></pre>

<h2 id="linux">Linux下终端输出有颜色的字</h2>
<pre><code class="sh">prt_color(){
    case $1 in
    &quot;green&quot; )#打印绿色字符串
        echo -e &quot;\033[32m&quot;&quot;$2&quot;&quot;\033[0m&quot;
        ;;
    &quot;azure&quot; )#打印天蓝色字符串
        echo -e &quot;\033[36m&quot;&quot;$2&quot;&quot;\033[0m&quot;
        ;;
    &quot;yellow&quot;)#打印黄色字符串
        echo -e &quot;\033[33m&quot;&quot;$2&quot;&quot;\033[0m&quot;
        ;;
    &quot;red&quot;   )#打印红色字符串
        echo -e &quot;\033[31m&quot;&quot;$2&quot;&quot;\033[0m&quot;
        ;;
    esac
}
</code></pre>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../Shell语法学习/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../Shell语法学习/" class="btn btn-xs btn-link">
        Shell语法学习笔记
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../Bash使用学习笔记/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../Bash使用学习笔记/" class="btn btn-xs btn-link">
        Bash使用学习笔记
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
      <p>
        <a href="https://github.com/furrybear/furrybear.github.io/edit/src/notes/2. Programming in Shell/Shell常用代码片段.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>