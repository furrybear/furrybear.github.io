<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="Furrybear">
    <link rel="canonical" href="https://furrybear.readthedocs.com/Progamming/C++/C++_Basic_Knowledge/">
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>不同数据类型内存大小 - Furrybear's Blog</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\u4e0d\u540c\u6570\u636e\u7c7b\u578b\u5185\u5b58\u5927\u5c0f", url: "#_top", children: [
          ]},
          {title: "char[]\u4f5c\u4e3a\u5f62\u53c2", url: "#char", children: [
          ]},
          {title: "\u6307\u9488\u7684\u5f15\u7528", url: "#_2", children: [
          ]},
          {title: "const\u5173\u952e\u5b57", url: "#const", children: [
          ]},
          {title: "\u7b49\u53f7\u64cd\u4f5c\u7b26", url: "#_3", children: [
          ]},
          {title: "decltype\u5173\u952e\u5b57", url: "#decltype", children: [
          ]},
          {title: "inline\u5173\u952e\u5b57", url: "#inline", children: [
          ]},
          {title: "noexcept\u5173\u952e\u5b57", url: "#noexcept", children: [
              {title: "noexcept\u4fee\u9970\u7b26", url: "#noexcept_1" },
              {title: "noexcept\u8fd0\u7b97\u7b26", url: "#noexcept_2" },
          ]},
          {title: "\u7c7b\u578b\u5f3a\u5236\u8f6c\u6362", url: "#_4", children: [
              {title: "const_cast", url: "#const_cast" },
              {title: "reinterpret_cast", url: "#reinterpret_cast" },
              {title: "static_cast\u548cdynamic_cast", url: "#static_castdynamic_cast" },
              {title: "C\u8bed\u8a00\u98ce\u683c\u8f6c\u5316\uff08\u4e0d\u63a8\u8350\uff09", url: "#c" },
          ]},
          {title: "foreach\uff08C++11\uff09", url: "#foreachc11", children: [
          ]},
          {title: "RAII", url: "#raii", children: [
          ]},
          {title: "RTTI", url: "#rtti", children: [
          ]},
          {title: "\u5185\u5b58\u5bf9\u9f50", url: "#_5", children: [
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../C++_Common_Library/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../C++_Common_Library/" class="btn btn-xs btn-link">
        C++ Common Library
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../Latex：基础知识/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../Latex：基础知识/" class="btn btn-xs btn-link">
        参考
      </a>
    </div>
    
  </div>

    

    <h1 id="_1">不同数据类型内存大小</h1>
<p><a href="https://wiki.wireshark.org/Development/Win64">https://wiki.wireshark.org/Development/Win64</a></p>
<table>
<thead>
<tr>
<th align="center">喵喵</th>
<th align="center">32位</th>
<th align="center">UNIX64位</th>
<th align="center">Windows64位</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">char</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">short</td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">int</td>
<td align="center">4</td>
<td align="center">4</td>
<td align="center">4</td>
</tr>
<tr>
<td align="center">long</td>
<td align="center">4</td>
<td align="center">8</td>
<td align="center">4</td>
</tr>
<tr>
<td align="center">long long</td>
<td align="center">8</td>
<td align="center">8</td>
<td align="center">8</td>
</tr>
<tr>
<td align="center">(pointer)</td>
<td align="center">4</td>
<td align="center">8</td>
<td align="center">8</td>
</tr>
<tr>
<td align="center">float</td>
<td align="center">4</td>
<td align="center">4</td>
<td align="center">4</td>
</tr>
<tr>
<td align="center">double</td>
<td align="center">8</td>
<td align="center">8</td>
<td align="center">8</td>
</tr>
</tbody>
</table>
<h1 id="char">char[]作为形参</h1>
<p>编译器把它作为<code>char *</code>处理。</p>
<h1 id="_2">指针的引用</h1>
<p><code>int *&amp; p;</code></p>
<h1 id="const">const关键字</h1>
<p>常量指针（Constant Pointer）：const int<em> p/int const</em> p</p>
<p>指针常量（Pointer to Constant）：int *const p</p>
<p>常量引用（Constant Reference）：const int&amp; p/int const&amp; p</p>
<h1 id="_3">等号操作符</h1>
<p>返回左边的值。</p>
<h1 id="decltype">decltype关键字</h1>
<p><a href="https://www.cnblogs.com/QG-whz/p/4952980.html">https://www.cnblogs.com/QG-whz/p/4952980.html</a></p>
<p>decltype与auto关键字一样，用于进行编译时类型推导。</p>
<pre><code class="cpp">int i = 4;
decltype(i) a;
</code></pre>

<pre><code class="cpp">template &lt;typename _Tx, typename _Ty&gt;
auto multiply(_Tx x, _Ty y)-&gt;decltype(_Tx*_Ty)
{
    return x*y;
}
</code></pre>

<h1 id="inline">inline关键字</h1>
<p><a href="https://www.cnblogs.com/fnlingnzb-learner/p/6423917.html">https://www.cnblogs.com/fnlingnzb-learner/p/6423917.html</a></p>
<p>内联函数。声明内联对编译器只是一个建议而已。inline必须放在函数定义而不是声明那里。</p>
<h1 id="noexcept">noexcept关键字</h1>
<h2 id="noexcept_1">noexcept修饰符</h2>
<p>C++11起，以下声明抛出哪些异常的方案被废弃了：</p>
<pre><code class="cpp">void foo() throw(异常1,异常2)
{
    //...
}
</code></pre>

<p>如果要表示函数不会抛出异常有以下几种表达方式：</p>
<pre><code class="cpp">//函数如果抛出异常就会自动调用std::terminate
void foo() noexcept
{
    //...
}
void foo2() noexcept(true)
{
    //...
}
void foo3() throw()
{
    //...
}
</code></pre>

<p>改用noexcept可以避免异常扩散。</p>
<p><img alt="" src="../keyword_noexcept_position.png" /></p>
<h2 id="noexcept_2">noexcept运算符</h2>
<p>（待补充）</p>
<h1 id="_4">类型强制转换</h1>
<p><a href="https://www.cnblogs.com/goodhacker/archive/2011/07/20/2111996.html">https://www.cnblogs.com/goodhacker/archive/2011/07/20/2111996.html</a></p>
<h2 id="const_cast">const_cast</h2>
<p>去const指针或者const引用的const属性，要求它们指向的对象没有const属性。</p>
<pre><code class="cpp">#include&lt;iostream&gt;
using namespace std;
int main(int argc, char const *argv[])
{
    const int a = 12;
    const int *p = &amp;a;
    int *tmp = const_cast&lt;int *&gt;(p);
    *tmp = 11;
    cout &lt;&lt; a;
}
</code></pre>

<h2 id="reinterpret_cast">reinterpret_cast</h2>
<p>不同类型的指针类型转换，只会做原样复制</p>
<h2 id="static_castdynamic_cast">static_cast和dynamic_cast</h2>
<p><a href="https://blog.csdn.net/qq_26849233/article/details/62218385">https://blog.csdn.net/qq_26849233/article/details/62218385</a></p>
<p>对于上行转换（子类到父类），dynamic_cast和static_cast是一样的。</p>
<p>对于下行转换，static_cast是编译时转换，dynamic_cast是运行时转换。</p>
<pre><code class="cpp">Base *P = new Base;
//能够返回指针，所以有越界风险
Derived *pd3 = static_cast&lt;Derived *&gt;(P);
//返回nullptr
Derived *pd4 = dynamic_cast&lt;Derived *&gt;(P);
</code></pre>

<p>众所周知，对于有虚函数的类或者虚拟机制的类</p>
<h2 id="c">C语言风格转化（不推荐）</h2>
<p>相当于const_cast、static_cast、reinterpret_cast挨个试一遍，哪个能用就用哪个。</p>
<h1 id="foreachc11">foreach（C++11）</h1>
<pre><code class="cpp">for(int&amp; value:vec) {   
    cout&lt;&lt;value&lt;&lt;endl;
}   
</code></pre>

<h1 id="raii">RAII</h1>
<p><a href="https://zh.wikipedia.org/wiki/RAII">https://zh.wikipedia.org/wiki/RAII</a></p>
<p>Resource Acquisition[ˌækwɪ'zɪʃn] Is Initialization。</p>
<p>RAII要求，资源的有效期与持有资源的对象的生命期严格绑定，即由对象的构造函数完成资源的分配(获取)，同时由析构函数完成资源的释放。在这种要求下，只要对象能正确地析构，就不会出现资源泄露问题。</p>
<h1 id="rtti">RTTI</h1>
<p>Run-Time Type Identification，Run-Time Type Information（运行期类型信息）。</p>
<h1 id="_5">内存对齐</h1>
<p><a href="http://www.cppblog.com/snailcong/archive/2009/03/16/76705.html">http://www.cppblog.com/snailcong/archive/2009/03/16/76705.html</a></p>
<p>如果一个变量的内存地址正好位于它长度的整数倍，他就被称做自然对齐。</p>
<p>随机访问内存地址对CPU来说是非常慢的，为了一次能取到变量的值，需要变量在内存中对齐。</p>
<p>基本类型的数据对齐值是其本身的大小，例如char为1字节，int为8字节（64位系统）。<strong>数组对齐值为其成员类型的对齐值。</strong></p>
<p>内存对齐的规则（结构体和联合体的对齐值计算）：</p>
<p><code>#pragma pack(P)</code>可以取的值为1、2、4、8、16、……，默认值为4或者8，表示CPU访问内存时以nP的地址为起点，一次拿走P字节的内存的内容。（n为自然数）</p>
<p>结构体要执行一下两步，联合体只要执行2就好了：</p>
<ol>
<li>
<p>对于结构体的各个成员，第一个成员位于偏移为0的位置，以后每个数据成员的偏移量必须是<strong>　min(P，这个数据成员的对齐值)*n　</strong>。也就是说，如果成员对齐值比P大，，它的起始地址必须为nP。</p>
</li>
<li>
<p>在数据成员完成各自对齐之后，结构体(或联合体)的对齐值为<strong>　min(P,结构体/联合体数据成员的最大对齐值)*n　</strong>。</p>
</li>
</ol>

  <br>
    

    
    
      
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../C++_Common_Library/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../C++_Common_Library/" class="btn btn-xs btn-link">
        C++ Common Library
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../Latex：基础知识/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../Latex：基础知识/" class="btn btn-xs btn-link">
        参考
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/furrybear/furrybear.github.io/edit/master/docs/Progamming/C++/C++_Basic_Knowledge.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>